#!/usr/bin/zsh
# This hook is sourced after every virtualenv is activated.

# Hack 1: Show the active virtualenv on the right side of my screen instead
PS1="$_OLD_VIRTUAL_PS1"
_OLD_RPROMPT="$RPROMPT"
RPROMPT=">`basename \"$VIRTUAL_ENV\"`<$RPROMPT"

# Hack 2: Changing the Default Behavior of cd
#
#   cd w/o args will go to the project root
cd () {
    if (( $# == 0 ))
    then
        builtin cd $PROJECT_HOME
    else
        builtin cd "$@"
    fi
}

# Hack 1: try to guess the project dir from venv name
#
#   change dir to the proj location
#   Adds the specified directories to the Python path for the currently-active virtualenv.
venv_name=$(basename $VIRTUAL_ENV)

proj_name=$venv_name

case $venv_name in
  "hlt") proj_name="howdoi-loadtest";;
  "ppy") proj_name="practice-python";;
esac

proj_fullpath="$PROJECT_HOME/$proj_name"

if [ -e $proj_fullpath ]
then
  echo "Identified Project: ${proj_fullpath}"
  add2virtualenv $proj_fullpath
  cd $proj_fullpath
fi
